name: Lint and Publish Wiki

on:
    push:
        branches:
            - main
    pull_request:

jobs:
    lint-wiki:
        name: Lint Markdown
        runs-on: ubuntu-latest
        steps:
            - name: Checkout code
              uses: actions/checkout@v5

            - name: Lint Markdown
              uses: ./src/wiki-lint
              with:
                  source-branch: main
                  ignore-paths: "src"

    publish-wiki:
        name: Publish Wiki
        # if: ${{ github.ref_name == 'main' && github.ref_type == 'branch' }}
        runs-on: ubuntu-latest
        needs: lint-wiki
        permissions:
            contents: write
        steps:
            - name: Checkout code
              uses: actions/checkout@v5

            - name: Publish Wiki
              uses: ./src/wiki-publish
